<!-- cancel-cfdi-dialog.component.html -->
<h2 mat-dialog-title>Cancelar CFDI</h2>

<mat-dialog-content class="space-y-4">
  <div class="text-sm">
    <div><b>UUID:</b> {{ data.uuid || '—' }}</div>
    <div><b>Serie/Folio:</b> {{ data.serie || '' }}{{ data.folio || '' }}</div>
    <div><b>Receptor:</b> {{ data.receptorRfc || '—' }}</div>
    <div><b>Total:</b> {{ data.total ?? '—' }}</div>
  </div>

  <mat-form-field class="w-full">
    <mat-label>Motivo de cancelación (SAT)</mat-label>
    <mat-select [formControl]="form.controls.motive">
      <mat-option *ngFor="let m of motives" [value]="m.value">
        {{ m.label }}
      </mat-option>
    </mat-select>
    <mat-hint>{{ selectedMotiveHelp }}</mat-hint>
  </mat-form-field>

  <mat-form-field class="w-full" *ngIf="form.controls.motive.value === '01'">
    <mat-label>UUID que sustituye (obligatorio)</mat-label>
    <input matInput [formControl]="form.controls.uuidReplacement" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
    <mat-error *ngIf="form.controls.uuidReplacement.hasError('required')">
      El UUID de sustitución es requerido para motivo 01.
    </mat-error>
    <mat-error *ngIf="form.controls.uuidReplacement.hasError('pattern')">
      Formato inválido. Debe ser un UUID.
    </mat-error>
  </mat-form-field>

  <mat-checkbox [formControl]="form.controls.confirm">
    Confirmo que deseo cancelar este CFDI
  </mat-checkbox>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="cancel()">Cerrar</button>
  <button mat-raised-button color="warn" (click)="submit()" [disabled]="form.invalid">
    Cancelar CFDI
  </button>
</mat-dialog-actions>